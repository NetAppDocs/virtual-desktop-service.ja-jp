---
sidebar: sidebar 
permalink: Deploying.GCP.vds_v5.4_prerequisites.html 
summary: GCP と VDS の前提条件 
---
= Google Compute Platform （ GCP ）と VDS の前提条件




== GCP と VDS の要件と注意事項

本ドキュメントでは、 NetApp Virtual Desktop Service （ VDS ）を使用して Remote Desktop Services （ RDS ）を導入するために必要な要素について説明します。「クイックチェックリスト」には、効率的な導入を実現するために必要なコンポーネントと導入前の手順の簡単なリストが記載されています。このガイドの残りの部分では、構成の選択内容に応じて、各要素の詳細を説明します。

image:ReferenceArchitectureGCPRDS.png["幅 = 75%"]



== クイックチェックリスト



=== GCP の要件

* GCP テナント
* GCP プロジェクト
* オーナーロールが割り当てられたサービスアカウント




=== 導入前の情報

* ユーザの総数を決定します
* GCP のリージョンとゾーンを特定します
* Active Directory のタイプを決定します
* ストレージの種類を確認します
* セッションホスト VM のイメージまたは要件を特定します
* 既存の GCP とオンプレミスのネットワーク構成を評価します




== VDS 環境詳細な要件



=== エンドユーザの接続要件

.GCP で RDS をサポートするリモートデスクトップクライアントは次のとおりです。
* link:https://docs.netapp.com/us-en/virtual-desktop-service/Reference.end_user_access.html#overview["Windows 用の NetApp VDS クライアント"]
+
** NetApp VDS Client for Windows アウトバウンド URL セーフリスト要件
+
*** api.cloudworkspace.com
*** vdsclient.app
*** api.vdsclient.app
*** bin.vdsclient.app


** 拡張機能：
+
*** VDS Wake On Demand
*** ThinPrint クライアントおよびスライスの使用
*** セルフサービスパスワードがリセットされました
*** サーバおよびゲートウェイアドレスの自動ネゴシエーション
*** デスクトップおよびストリーミング・アプリケーションの完全サポート
*** カスタムブランディングが可能です
*** 導入と設定を自動化するためのインストーラスイッチ
*** トラブルシューティングツールが組み込まれています




* link:https://login.cloudworkspace.com/["NetApp VDS Web クライアント"]
* link:https://docs.microsoft.com/en-us/windows-server/remote/remote-desktop-services/clients/remote-desktop-clients["Microsoft RD Client"]
+
** Windows の場合
** MacOS
** .iso
** Android


* サードパーティ製ソフトウェアまたはシンクライアント
+
** 要件： RD ゲートウェイ設定をサポートします






==== ストレージレイヤ

VDS で導入された RDS では、永続的なユーザ / 企業データが AVD セッション VM に存在しないようにストレージ戦略が設計されています。ユーザプロファイル、ユーザファイル、フォルダ、および企業 / アプリケーションデータの永続的データは、独立したデータレイヤでホストされている 1 つ以上のデータボリュームでホストされます。

FSLogix は ' セッション初期化時にユーザー・プロファイル・コンテナ（ VHD または VHDX フォーマット）をセッション・ホストにマウントすることによって ' ユーザー・プロファイルの多くの問題（データのスプロール化やログインの遅延など）を解決する ' プロファイルのコンテナ化テクノロジーです

このアーキテクチャのため、データストレージ機能が必要です。この機能は、ユーザーのログイン / ログオフの大部分が同時に発生したときに、毎朝 / 午後に必要となるデータ転送を処理できる必要があります。中規模の環境であっても、データ転送には大きな要件があります。データストレージレイヤのディスクパフォーマンスは、プライマリエンドユーザのパフォーマンス変数の 1 つです。ストレージ容量だけでなく、このストレージのパフォーマンスを適切にサイジングするには、特に注意が必要です。一般に、ストレージレイヤは、ユーザあたり 5~15 IOPS をサポートするようにサイズを設定します。



==== ネットワーキング

* 必須： * VPN 経由で GCP プロジェクトから認識できるサブネットを含む、既存のすべてのネットワークサブネットのインベントリ。サブネットが重複しないように環境を構成する必要があります。

VDS セットアップウィザードでは、既存のネットワークとの統合計画の一環として、必要な範囲がある場合、または回避する必要がある場合にネットワークの範囲を定義できます。

導入時にユーザが使用する IP 範囲を決定します。ベストプラクティスに従い、プライベートレンジの IP アドレスのみがサポートされます。

.サポートされる選択肢は次のとおりですが、デフォルトは /20 範囲です。
* 192.168.0.0 ～ 192.168.255.255
* 172.16.0.0 ～ 172.31.255.255
* 10.0.0.0 ～ 10.255.255.255




==== CWMGR1

コスト削減ワークロードスケジューリング機能やライブスケーリング機能など、 VDS 固有の機能の一部では、組織およびプロジェクト内に管理者としての存在が必要です。したがって、 VDS セットアップウィザードの自動化の一環として、 CWMGR1 という管理 VM が導入されます。VDS の自動化タスクに加えて、この VM は、 SQL Express データベース、ローカルログファイル、および DCConfig という高度な設定ユーティリティで VDS の設定も保持します。

.VDS セットアップウィザードで選択した内容に応じて、この VM を使用して次の追加機能をホストできます。
* RDS ゲートウェイ
* HTML 5 ゲートウェイ
* RDS ライセンスサーバー
* ドメインコントローラ




=== Deployment Wizard の Decision Tree を参照してください

初期導入の一環として、新しい環境の設定をカスタマイズするための一連の質問に回答します。以下に、主要な決定事項の概要を示します。



==== GCP リージョン

VDS 仮想マシンをホストする GCP リージョンを決定します。エンドユーザと利用可能なサービスに基づいてリージョンを選択する必要があります。



==== データストレージ

ユーザプロファイル、個々のファイル、および企業共有のデータをどこに配置するかを決定します。次の選択肢があります。

* Cloud Volumes Service for GCP
* 従来のファイルサーバ




== ネットアップ VDS 導入の要件 - 既存のコンポーネント



=== 既存の Active Directory ドメインコントローラを使用した NetApp VDS の導入

この設定タイプは、 RDS インスタンスをサポートするために既存の Active Directory ドメインを拡張します。この場合 'VDS は限定されたコンポーネントセットをドメインに展開し 'RDS コンポーネントの自動プロビジョニングと管理タスクをサポートします

.この構成には、次のものが
* GCP VPC ネットワーク上の VM からアクセスできる既存の Active Directory ドメインコントローラ。通常は、 VPN または GCP で作成されたドメインコントローラを介してアクセスできます。
* ドメインに参加する際の RDS ホストとデータボリュームの VDS 管理に必要な VDS コンポーネントと権限の追加。配置プロセスでは、必要な要素を作成するスクリプトを実行するために、ドメイン権限を持つドメインユーザーが必要です。
* VDS 環境では、作成された VM について、デフォルトで VPC ネットワークが作成されます。VPC ネットワークは、既存の VPC ネットワークとピア関係に設定することも、 CWMGR1 VM は、必要なサブネットが事前定義されている既存の VPC ネットワークに移動することもできます。




==== クレデンシャルとドメイン準備ツール

管理者は、導入プロセスのある時点でドメイン管理者の資格情報を提供する必要があります。ドメイン管理者の一時的な資格情報は、後で作成、使用、および削除できます（展開プロセスが完了した後）。また、前提条件の構築にサポートが必要なお客様は、ドメイン準備ツールを利用できます。



=== ネットアップ VDS 環境に既存のファイルシステムがある場合

VDS では、ユーザープロファイル、個人フォルダ、および企業データに RDS セッションホストからアクセスできるようにする Windows 共有が作成されます。VDS はデフォルトでファイルサーバーを配備しますが ' 既存のファイルストレージコンポーネント VDS がある場合 'VDS の配備が完了したらそのコンポーネントを指すことができます

.と既存のストレージコンポーネントを使用するための要件は次のとおりです。
* コンポーネントが SMB v3 をサポートしている必要があります
* このコンポーネントは、 RDS セッションホストと同じ Active Directory ドメインに参加している必要があります。
* VDS 構成で使用する UNC パスをコンポーネントで公開できる必要があります。 3 つの共有すべてに 1 つのパスを使用することも、それぞれに別々のパスを指定することもできます。VDS ではこれらの共有に対するユーザレベルの権限が設定されることに注意してください。 VDS Automation Services に適切な権限が付与されていることを確認してください。




== 付録 A ： VDS コントロールプレーンの URL と IP アドレス

GCP プロジェクトの VDS コンポーネントは、 VDS Web アプリケーションや VDS API エンドポイントなど、 Azure でホストされる VDS グローバルコントロールプレーンコンポーネントと通信します。アクセスするには、次のベース URI アドレスを、ポート 443 で双方向アクセスのためにセーフリストに登録する必要があります。

link:api.cloudworkspace.com[""]
link:autoprodb.database.windows.net[""]
link:vdctoolsapi.trafficmanager.net[""]
link:cjbootstrap3.cjautomate.net[""]

アクセス制御デバイスが IP アドレスによるセーフリストのみを許可する場合、次の IP アドレスリストはセーフリストに登録する必要があります。VDS では冗長パブリック IP アドレスを持つロードバランサが使用されるため、このリストは時間の経過とともに変更される可能性があります。

13.67.190.243 13.67.215.62 13.89.50.122 13.67.227.115 13.67.227.230 13.67.227.67.227.9227.227.9227.92.239.1519.157 40.78.132.16.2.132.132.132.132.112.142.142.118.114.82.118.118.114.82.148.114.82.113.142.132.132.132.132.132.132.132.132.132.132.132.132.132.142.142.132.142.142.142.132.132.132.142.132.132.132.142.142.142.142.142.132.142.132.132.132.132.142.142.



=== 最適なパフォーマンス要因

最適なパフォーマンスを得るには、ネットワークが次の要件を満たしていることを確認します。

* クライアントのネットワークから、セッションホストが配置されている GCP リージョンへのラウンドトリップ（ RTT ）レイテンシは 150 ミリ秒未満である必要があります。
* デスクトップやアプリケーションをホストする VM が管理サービスに接続されている場合、ネットワークトラフィックが国や地域の境界を越えて流れることがあります。
* ネットワークパフォーマンスを最適化するには、セッションホストの VM を管理サービスと同じリージョンに配置することを推奨します。




=== サポートされる仮想マシンの OS イメージ

VDS によって配備された RDS セッションの動作は、次の x64 オペレーティングシステムイメージをサポートします。

* Windows Server 2019
* Windows Server 2016
* Windows Server 2012 R2

